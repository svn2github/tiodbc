<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TinyODBC: tiodbc::statement Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="namespacetiodbc.html">tiodbc</a>      </li>
      <li><a class="el" href="classtiodbc_1_1statement.html">tiodbc::statement</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>tiodbc::statement Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="tiodbc::statement" -->
<p>An ODBC statement representation object.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="tiodbc_8hpp_source.html">tiodbc.hpp</a>&gt;</code></p>

<p><a href="classtiodbc_1_1statement-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#ac552a637e9f9c5fddca9349e0aa6cc2e">statement</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor.  <a href="#ac552a637e9f9c5fddca9349e0aa6cc2e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#ae4983f960b256657490ef04e60b6fed1">statement</a> (<a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;_conn, const <a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;_stmt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct and prepare.  <a href="#ae4983f960b256657490ef04e60b6fed1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a5cd074a713ee48be33eafe051b9005b7">~statement</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#a5cd074a713ee48be33eafe051b9005b7"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
Core functionality</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp18914260ff1331086bb4f623954868b7"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#ab3b67afb374e1f832a9e35895bfc6533">open</a> (<a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;_conn)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used to create a statement (used automatically by the "statement construction" functions).  <a href="#ab3b67afb374e1f832a9e35895bfc6533"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac34ae8bd2d2a2e4036039412b47dcee2"></a><!-- doxytag: member="tiodbc::statement::is_open" ref="ac34ae8bd2d2a2e4036039412b47dcee2" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#ac34ae8bd2d2a2e4036039412b47dcee2">is_open</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if it is an open statement. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a1813a912eb6b16e2fd29f5ca91f5b4b0">close</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close statement.  <a href="#a1813a912eb6b16e2fd29f5ca91f5b4b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HDBC&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a1282be7fd62870f8adb587a60da9a5b0">native_stmt_handle</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get native HSTMT handle.  <a href="#a1282be7fd62870f8adb587a60da9a5b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a76e3d7ac6b66e06e81c85c544aba491b">last_error</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get last error description.  <a href="#a76e3d7ac6b66e06e81c85c544aba491b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a6153fa235253c8f9974a0d69762607a6">last_error_status_code</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get last error code.  <a href="#a6153fa235253c8f9974a0d69762607a6"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
Statement construction</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrpd0a74a7270b4edeb396290255479749f"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a156c2dc4b2ab5db66cf4c6e473257714">prepare</a> (<a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;_conn, const <a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;_stmt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare a query.  <a href="#a156c2dc4b2ab5db66cf4c6e473257714"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a1633667ca4afc17cbd5b9dfe9d9822a5">execute_direct</a> (<a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;_conn, const <a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;_query)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute directly an sql query to the server.  <a href="#a1633667ca4afc17cbd5b9dfe9d9822a5"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
Result gathering</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp8808801b37679ac0ff087e879cdff142"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#abab8c3c07df365827230600c7c1576db">execute</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute a prepared statement.  <a href="#abab8c3c07df365827230600c7c1576db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24">fetch_next</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fetch next result row.  <a href="#a8666cc7f161c58ddb0dbde138cd09d24"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classtiodbc_1_1field__impl.html">field_impl</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380">field</a> (int _num) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a field of the current row in the result set.  <a href="#a346c38630d3fc9b2444832592ea92380"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a33c9ea30bcee5efe5a1fe3a318f6ca9c">count_columns</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Count columns of the result set.  <a href="#a33c9ea30bcee5efe5a1fe3a318f6ca9c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7fb4c9e40395236e82438ff609ade8b0"></a><!-- doxytag: member="tiodbc::statement::free_results" ref="a7fb4c9e40395236e82438ff609ade8b0" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a7fb4c9e40395236e82438ff609ade8b0">free_results</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free current opened result set. <br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
Parameters handling</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrp760bd830d85bd0aaee8506f43e7e0d26"></a> </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtiodbc_1_1param__impl.html">param_impl</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a81b7f2c1f9ad1c922e57b38bbdbc8042">param</a> (int _num)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle a parameter.  <a href="#a81b7f2c1f9ad1c922e57b38bbdbc8042"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#a76d8d1523dcc0bc344b5c40c50721336">reset_parameters</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset parameters (unbind all parameters).  <a href="#a76d8d1523dcc0bc344b5c40c50721336"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>An ODBC statement representation object. </p>
<p>Represents a statement on the server. Statement is used to execute direct queries or prepare them and execute them multiple times with same or different parameters.</p>
<p>A statement has a life-cycle from the time is opened to the time it is closed. A closed statement can be reused by reopening it.</p>
<p>There is no need to directly open a statement, this is done automatically from the "statement construction" functions. </p>
<dl class="note"><dt><b>Note:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">tiodbc::statement</a> is <b>Uncopiable</b> and <b>NON inheritable</b> </dd></dl>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac552a637e9f9c5fddca9349e0aa6cc2e"></a><!-- doxytag: member="tiodbc::statement::statement" ref="ac552a637e9f9c5fddca9349e0aa6cc2e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tiodbc::statement::statement </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default constructor. </p>
<p>It will construct a statement ready to execute or prepare a query. At the construction time statement is not opened, but it is ready to. </p>

</div>
</div>
<a class="anchor" id="ae4983f960b256657490ef04e60b6fed1"></a><!-- doxytag: member="tiodbc::statement::statement" ref="ae4983f960b256657490ef04e60b6fed1" args="(connection &amp;_conn, const _tstring &amp;_stmt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tiodbc::statement::statement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_stmt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Construct and prepare. </p>
<p>It will construct and open a new statement at a desired connection and prepare a query on it. After the construction the statement will be in open mode and will hold the prepared statement. You can use it to execute the statement multiple times, by passing (if any) different parameters. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_conn</em>&nbsp;</td><td>The connection object to prepare the query on it. Queries are always prepared on servers. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_stmt</em>&nbsp;</td><td>The sql query to prepare.</td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The prepared query is <b>not</b> stored on server but it is temporary and will get deleted when the connection is closed or the statement.</dd></dl>
<p>To check if the query was prepared successfully you can run <a class="el" href="classtiodbc_1_1statement.html#ac34ae8bd2d2a2e4036039412b47dcee2" title="Check if it is an open statement.">is_open()</a> after construction to see if it is opened. If the preparation fails, you can use this statement object to open other queries, direct or prepared.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If you want to execute a direct query to the server without preparing it, you can use <a class="el" href="classtiodbc_1_1statement.html#a1633667ca4afc17cbd5b9dfe9d9822a5" title="Execute directly an sql query to the server.">execute_direct()</a> after constructing a statement with the default constructor! </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a156c2dc4b2ab5db66cf4c6e473257714" title="Prepare a query.">prepare()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a5cd074a713ee48be33eafe051b9005b7"></a><!-- doxytag: member="tiodbc::statement::~statement" ref="a5cd074a713ee48be33eafe051b9005b7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tiodbc::statement::~statement </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destructor. </p>
<p>It will close the query or delete the store prepared query, and close the result cursor if any. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a1813a912eb6b16e2fd29f5ca91f5b4b0" title="Close statement.">close()</a>; </dd></dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a1813a912eb6b16e2fd29f5ca91f5b4b0"></a><!-- doxytag: member="tiodbc::statement::close" ref="a1813a912eb6b16e2fd29f5ca91f5b4b0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiodbc::statement::close </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close statement. </p>
<p>It will close the statement, delete any stored results or prepared queries, or stored parameters. </p>

</div>
</div>
<a class="anchor" id="a33c9ea30bcee5efe5a1fe3a318f6ca9c"></a><!-- doxytag: member="tiodbc::statement::count_columns" ref="a33c9ea30bcee5efe5a1fe3a318f6ca9c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tiodbc::statement::count_columns </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Count columns of the result set. </p>
<p>It will return the number of columns of the current open result set. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>If the operation was <b>successful</b> it will return a number <b>bigger than zero</b>.</li>
<li><b>Less than zero or equal to</b> in case of any <b>error</b>.</li>
</ul>
</dd></dl>
<p><a class="el" href="_examples.html#example_2">Example 2: Execute directly an sql query and get results.</a> </p>

</div>
</div>
<a class="anchor" id="abab8c3c07df365827230600c7c1576db"></a><!-- doxytag: member="tiodbc::statement::execute" ref="abab8c3c07df365827230600c7c1576db" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::execute </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Execute a prepared statement. </p>
<p>It will execute the query that was previously prepared in this statement.</p>
<p>To execute a prepared query there are some preconditions that must be satisfied.<br/>
</p>
<ul>
<li>The statement must be opened and an sql query must have been prepared.</li>
<li>Any previous result set must be have been freed.</li>
<li>All the parameters of the prepared statement must been passed with <a class="el" href="classtiodbc_1_1statement.html#a81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param()</a></li>
</ul>
<dl class="return"><dt><b>Returns:</b></dt><dd><b>True</b> if the prepared query was successfully executed or <b>False</b> if there was an error. In case of error check <a class="el" href="classtiodbc_1_1statement.html#a76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error()</a> for detailed description of problem.</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>After a successfully execution of a query, the result cursor is pointed one slot before first row. To get the results of first row you must first call once <a class="el" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a> and then use <a class="el" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a> to get each field of the current row.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a>, <a class="el" href="classtiodbc_1_1statement.html#a33c9ea30bcee5efe5a1fe3a318f6ca9c" title="Count columns of the result set.">count_columns()</a>, <a class="el" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a>, <a class="el" href="classtiodbc_1_1statement.html#a1813a912eb6b16e2fd29f5ca91f5b4b0" title="Close statement.">close()</a></dd></dl>
<p><a class="el" href="_examples.html#example_4">Example 4: Prepare a statement and execute it multiple times</a> </p>

</div>
</div>
<a class="anchor" id="a1633667ca4afc17cbd5b9dfe9d9822a5"></a><!-- doxytag: member="tiodbc::statement::execute_direct" ref="a1633667ca4afc17cbd5b9dfe9d9822a5" args="(connection &amp;_conn, const _tstring &amp;_query)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::execute_direct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_query</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Execute directly an sql query to the server. </p>
<p>It will close any previous opened operation and will execute directly the desired sql query at the server.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_conn</em>&nbsp;</td><td>The connection object with the server where the query will be executed at. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_query</em>&nbsp;</td><td>The sql query that will be execute at the server. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><b>True</b> if the execution was successful or <b>False</b> if there was an error. In case of error check <a class="el" href="classtiodbc_1_1statement.html#a76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error()</a> for detailed description of problem. </dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>After a successful execution of a query, the result cursor is pointed one slot before first row. To get the results of first row you must first call once <a class="el" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a> and then use <a class="el" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a> to get each field of the current row.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This is a <b>"statement construction" function</b> which means that any previous opened operation of this statement will be closed and a new statement will be created. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a>, <a class="el" href="classtiodbc_1_1statement.html#a33c9ea30bcee5efe5a1fe3a318f6ca9c" title="Count columns of the result set.">count_columns()</a>, <a class="el" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a>, <a class="el" href="classtiodbc_1_1statement.html#a1813a912eb6b16e2fd29f5ca91f5b4b0" title="Close statement.">close()</a></dd></dl>
<p><a class="el" href="_examples.html#example_2">Example 2: Execute directly an sql query and get results.</a> <br/>
 <a class="el" href="_examples.html#example_3">Example 3: Execute directly an "INSERT" sql query.</a> </p>

</div>
</div>
<a class="anchor" id="a8666cc7f161c58ddb0dbde138cd09d24"></a><!-- doxytag: member="tiodbc::statement::fetch_next" ref="a8666cc7f161c58ddb0dbde138cd09d24" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::fetch_next </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fetch next result row. </p>
<p>If the statement has opened a result set, it will advance the cursor to the next row. Result sets are opened automatically when executing an sql query that returns some results.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li><b>True</b> if the cursor was advanced successfully.</li>
<li><b>False</b> if the end of result set has been reached or there isn't opened any result set.</li>
</ul>
</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a></dd></dl>
<p><a class="el" href="_examples.html#example_2">Example 2: Execute directly an sql query and get results.</a> <a class="el" href="_examples.html#example_4">Example 4: Prepare a statement and execute it multiple times</a> </p>

</div>
</div>
<a class="anchor" id="a346c38630d3fc9b2444832592ea92380"></a><!-- doxytag: member="tiodbc::statement::field" ref="a346c38630d3fc9b2444832592ea92380" args="(int _num) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classtiodbc_1_1field__impl.html">field_impl</a> tiodbc::statement::field </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>_num</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a field of the current row in the result set. </p>
<p>It will return a field of the current selected row from the result set. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_num</em>&nbsp;</td><td>The column of the field that you want to retrieve. First column is the 1. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>If the operation was successful a valid <a class="el" href="classtiodbc_1_1field__impl.html" title="Representation of result set field.">field_impl</a> object that contains info about the selected field.</li>
<li>An invalid <a class="el" href="classtiodbc_1_1field__impl.html" title="Representation of result set field.">field_impl</a> if there isn't any result set opened or the result cursor is not pointing to any valid row, or the number of the field was wrong. </li>
</ul>
</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Objects returns from <a class="el" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a> should be used directly and must not be stored.<br/>
 <b>good</b> example: <div class="fragment"><pre class="fragment"> m_long = <a class="code" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field</a>(1).as_long() 
</pre></div><br/>
 <b>bad</b> example: <div class="fragment"><pre class="fragment"> field_impl tmp_field = <a class="code" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field</a>(1);  m_long = tmp_field.as_long(); 
</pre></div> </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a>;</dd></dl>
<p><a class="el" href="_examples.html#example_2">Example 2: Execute directly an sql query and get results.</a> <br/>
 <a class="el" href="_examples.html#example_4">Example 4: Prepare a statement and execute it multiple times</a> </p>

</div>
</div>
<a class="anchor" id="a76e3d7ac6b66e06e81c85c544aba491b"></a><!-- doxytag: member="tiodbc::statement::last_error" ref="a76e3d7ac6b66e06e81c85c544aba491b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a> tiodbc::statement::last_error </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get last error description. </p>
<p>Get the description of the error that occurred with the last function call. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the last function call was successful it will return an empty string, otherwise it will return the description of the error that occurred inside the ODBC driver. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a6153fa235253c8f9974a0d69762607a6" title="Get last error code.">last_error_status_code()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a6153fa235253c8f9974a0d69762607a6"></a><!-- doxytag: member="tiodbc::statement::last_error_status_code" ref="a6153fa235253c8f9974a0d69762607a6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a> tiodbc::statement::last_error_status_code </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get last error code. </p>
<p>Get the status of the error that occurred with the last function call. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the last function call was successful it will return an empty string, otherwise it will return the status code of the error that occurred inside the ODBC driver. </dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The status codes are unique 5 length strings that correspond to a unique error. For information of this status code check ODBC API Reference (<a href="http://msdn.microsoft.com/en-us/library/ms716412(VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms716412(VS.85).aspx</a>)</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error()</a>; </dd></dl>

</div>
</div>
<a class="anchor" id="a1282be7fd62870f8adb587a60da9a5b0"></a><!-- doxytag: member="tiodbc::statement::native_stmt_handle" ref="a1282be7fd62870f8adb587a60da9a5b0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HDBC tiodbc::statement::native_stmt_handle </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get native HSTMT handle. </p>
<p>This is the <b>Statement</b> handle that the object has allocated internally with ODBC ISO API. This handle can be useful to anyone who needs to use ODBC ISO API Along with TinyODBC. </p>

</div>
</div>
<a class="anchor" id="ab3b67afb374e1f832a9e35895bfc6533"></a><!-- doxytag: member="tiodbc::statement::open" ref="ab3b67afb374e1f832a9e35895bfc6533" args="(connection &amp;_conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_conn</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used to create a statement (used automatically by the "statement construction" functions). </p>
<p>There is no need to call this function directly. It is called by "Statement construction" function when they want to open a new fresh statement with the server.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_conn</em>&nbsp;</td><td>The connection to the server where the statement will be opened inside it.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li><b>True</b> If the statement was successfully opened in the server.</li>
<li><b>False</b> If there was an error creating the statement.</li>
</ul>
</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>If there was an error opening a statement you can check for detailed error description with <a class="el" href="classtiodbc_1_1connection.html#a07d9e69f8b6d25af44e75f4fb6fe32d2" title="Get last error description.">connection::last_error()</a> of the connection object that you tried to open the connection and <b>NOT</b> by calling <a class="el" href="classtiodbc_1_1statement.html#a76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">statement::last_error()</a> as a closed statement is unable to do error reporting. </dd></dl>

</div>
</div>
<a class="anchor" id="a81b7f2c1f9ad1c922e57b38bbdbc8042"></a><!-- doxytag: member="tiodbc::statement::param" ref="a81b7f2c1f9ad1c922e57b38bbdbc8042" args="(int _num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtiodbc_1_1param__impl.html">param_impl</a> &amp; tiodbc::statement::param </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>_num</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle a parameter. </p>
<p>Returns a handle to a parameter of the prepared statement. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_num</em>&nbsp;</td><td>The parameter number, starting from 1. This is the way ODBC uses to identify the parameter markers. If there are three parameters, the leftmost one is parameter no.1 and the rightmost is parameter no.3</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>If the operation was successful a valid <a class="el" href="classtiodbc_1_1param__impl.html" title="Handler prepared statements parameters.">param_impl</a> object that can be used to set a value to the specific parameter.</li>
<li>An invalid <a class="el" href="classtiodbc_1_1param__impl.html" title="Handler prepared statements parameters.">param_impl</a> object if there isn't any prepared statement, or the parameter number is wrong. </li>
</ul>
</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Objects returns from <a class="el" href="classtiodbc_1_1statement.html#a81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param()</a> should be used directly and must not be stored.<br/>
 <b>good</b> example: <div class="fragment"><pre class="fragment"> = <a class="code" href="classtiodbc_1_1statement.html#a81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param</a>(1).set_as_long(1) 
</pre></div><br/>
 <b>bad</b> example: <div class="fragment"><pre class="fragment"> param_impl tmp_parm = <a class="code" href="classtiodbc_1_1statement.html#a81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param</a>(1);  tmp_parm.set_as_long(1); 
</pre></div> </dd></dl>

</div>
</div>
<a class="anchor" id="a156c2dc4b2ab5db66cf4c6e473257714"></a><!-- doxytag: member="tiodbc::statement::prepare" ref="a156c2dc4b2ab5db66cf4c6e473257714" args="(connection &amp;_conn, const _tstring &amp;_stmt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacetiodbc.html#a7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_stmt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prepare a query. </p>
<p>It will close any previous open operation and will prepare an sql query for execution. For more information about <b>query preparation</b> visit <a href="http://msdn.microsoft.com/en-us/library/ms716365.aspx">http://msdn.microsoft.com/en-us/library/ms716365.aspx</a></p>
<p>If you need to execute direct an sql query directly you can use <a class="el" href="classtiodbc_1_1statement.html#a1633667ca4afc17cbd5b9dfe9d9822a5" title="Execute directly an sql query to the server.">execute_direct()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_conn</em>&nbsp;</td><td>The connection object to prepare the query on it. Queries are always prepared on servers. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_stmt</em>&nbsp;</td><td>The sql query to prepare. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><b>True</b> if the preparation was successful or <b>False</b> if there was an error. In case of error check <a class="el" href="classtiodbc_1_1statement.html#a76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error()</a> for detailed description of error.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This is a <b>"statement construction" function</b> which means that any previous opened operation of this statement will be closed and a new statement will be created. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#a81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param()</a>, <a class="el" href="classtiodbc_1_1statement.html#abab8c3c07df365827230600c7c1576db" title="Execute a prepared statement.">execute()</a>, <a class="el" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a>, <a class="el" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a>, <a class="el" href="classtiodbc_1_1statement.html#a1813a912eb6b16e2fd29f5ca91f5b4b0" title="Close statement.">close()</a></dd></dl>
<p><a class="el" href="_examples.html#example_4">Example 4: Prepare a statement and execute it multiple times</a> </p>

</div>
</div>
<a class="anchor" id="a76d8d1523dcc0bc344b5c40c50721336"></a><!-- doxytag: member="tiodbc::statement::reset_parameters" ref="a76d8d1523dcc0bc344b5c40c50721336" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiodbc::statement::reset_parameters </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reset parameters (unbind all parameters). </p>
<p>It will remove (unbind) all the setted parameters of the prepared statement.</p>
<p>In case that this is not a prepared statement it will fail silently. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/sque/vcs/tiodbc/<a class="el" href="tiodbc_8hpp_source.html">tiodbc.hpp</a></li>
<li>/home/sque/vcs/tiodbc/tiodbc.cpp</li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Typedefs</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Thu Mar 10 2011 03:02:28 for TinyODBC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
