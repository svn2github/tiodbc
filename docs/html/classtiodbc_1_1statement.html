<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>TinyODBC: tiodbc::statement Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacetiodbc.html">tiodbc</a>::<a class="el" href="classtiodbc_1_1statement.html">statement</a>
  </div>
</div>
<div class="contents">
<h1>tiodbc::statement Class Reference</h1><!-- doxytag: class="tiodbc::statement" -->An ODBC <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> representation object.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="tiodbc_8hpp-source.html">tiodbc.hpp</a>&gt;</code>
<p>

<p>
<a href="classtiodbc_1_1statement-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Core functionality</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#b3b67afb374e1f832a9e35895bfc6533">open</a> (<a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;_conn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used to create a <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> (used automatically by the "statement construction" functions).  <a href="#b3b67afb374e1f832a9e35895bfc6533"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c34ae8bd2d2a2e4036039412b47dcee2"></a><!-- doxytag: member="tiodbc::statement::is_open" ref="c34ae8bd2d2a2e4036039412b47dcee2" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#c34ae8bd2d2a2e4036039412b47dcee2">is_open</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if it is an open <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#1813a912eb6b16e2fd29f5ca91f5b4b0">close</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>.  <a href="#1813a912eb6b16e2fd29f5ca91f5b4b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">HDBC&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#1282be7fd62870f8adb587a60da9a5b0">native_stmt_handle</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get native HSTMT handle.  <a href="#1282be7fd62870f8adb587a60da9a5b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#76e3d7ac6b66e06e81c85c544aba491b">last_error</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get last error description.  <a href="#76e3d7ac6b66e06e81c85c544aba491b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#6153fa235253c8f9974a0d69762607a6">last_error_status_code</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get last error code.  <a href="#6153fa235253c8f9974a0d69762607a6"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Statement construction</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#156c2dc4b2ab5db66cf4c6e473257714">prepare</a> (<a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;_conn, const <a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;_stmt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare a query.  <a href="#156c2dc4b2ab5db66cf4c6e473257714"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#1633667ca4afc17cbd5b9dfe9d9822a5">execute_direct</a> (<a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;_conn, const <a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;_query)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute directly an sql query to the server.  <a href="#1633667ca4afc17cbd5b9dfe9d9822a5"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Result gathering</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#bab8c3c07df365827230600c7c1576db">execute</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute a prepared <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>.  <a href="#bab8c3c07df365827230600c7c1576db"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#8666cc7f161c58ddb0dbde138cd09d24">fetch_next</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fetch next result row.  <a href="#8666cc7f161c58ddb0dbde138cd09d24"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="classtiodbc_1_1field__impl.html">field_impl</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380">field</a> (int _num) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a field of the current row in the result set.  <a href="#346c38630d3fc9b2444832592ea92380"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#33c9ea30bcee5efe5a1fe3a318f6ca9c">count_columns</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Count columns of the result set.  <a href="#33c9ea30bcee5efe5a1fe3a318f6ca9c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7fb4c9e40395236e82438ff609ade8b0"></a><!-- doxytag: member="tiodbc::statement::free_results" ref="7fb4c9e40395236e82438ff609ade8b0" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#7fb4c9e40395236e82438ff609ade8b0">free_results</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free current opened result set. <br></td></tr>
<tr><td colspan="2"><br><h2>Parameters handling</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classtiodbc_1_1param__impl.html">param_impl</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#81b7f2c1f9ad1c922e57b38bbdbc8042">param</a> (int _num)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle a parameter.  <a href="#81b7f2c1f9ad1c922e57b38bbdbc8042"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#76d8d1523dcc0bc344b5c40c50721336">reset_parameters</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset parameters (unbind all parameters).  <a href="#76d8d1523dcc0bc344b5c40c50721336"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#c552a637e9f9c5fddca9349e0aa6cc2e">statement</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor.  <a href="#c552a637e9f9c5fddca9349e0aa6cc2e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#e4983f960b256657490ef04e60b6fed1">statement</a> (<a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;_conn, const <a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;_stmt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct and prepare.  <a href="#e4983f960b256657490ef04e60b6fed1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiodbc_1_1statement.html#5cd074a713ee48be33eafe051b9005b7">~statement</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#5cd074a713ee48be33eafe051b9005b7"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
An ODBC <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> representation object. 
<p>
Represents a <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> on the server. Statement is used to execute direct queries or prepare them and execute them multiple times with same or different parameters.<p>
A <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> has a life-cycle from the time is opened to the time it is closed. A closed <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> can be reused by reopening it.<p>
There is no need to directly open a <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>, this is done automatically from the "statement construction" functions. <dl class="note" compact><dt><b>Note:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">tiodbc::statement</a> is <b>Uncopiable</b> and <b>NON inheritable</b> </dd></dl>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="c552a637e9f9c5fddca9349e0aa6cc2e"></a><!-- doxytag: member="tiodbc::statement::statement" ref="c552a637e9f9c5fddca9349e0aa6cc2e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tiodbc::statement::statement           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Default constructor. 
<p>
It will construct a <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> ready to execute or prepare a query. At the construction time <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> is not opened, but it is ready to. 
</div>
</div><p>
<a class="anchor" name="e4983f960b256657490ef04e60b6fed1"></a><!-- doxytag: member="tiodbc::statement::statement" ref="e4983f960b256657490ef04e60b6fed1" args="(connection &amp;_conn, const _tstring &amp;_stmt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tiodbc::statement::statement           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_stmt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Construct and prepare. 
<p>
It will construct and open a new <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> at a desired connectiona and prepare a query on it. After the construction the <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> will be in open mode and will hold the prepared <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>. You can use it to execute the stament multiple times, by passing (if any) different parameters. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_conn</em>&nbsp;</td><td>The <a class="el" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">connection</a> object to prepare the query on it. Queries are always prepared on servers. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_stmt</em>&nbsp;</td><td>The sql query to prepare.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>The prepared query is <b>not</b> stored on server but it is temporary and will get deleted when the <a class="el" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">connection</a> is closed or the <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>.</dd></dl>
To check if the query was prepared succesfully you can run <a class="el" href="classtiodbc_1_1statement.html#c34ae8bd2d2a2e4036039412b47dcee2" title="Check if it is an open statement.">is_open()</a> after construction to see if it is opened. If the preparation fails, you can use this <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> object to open other queries, direct or prepared.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>If you want to execute a direct query to the server without preparing it, you can use <a class="el" href="classtiodbc_1_1statement.html#1633667ca4afc17cbd5b9dfe9d9822a5" title="Execute directly an sql query to the server.">execute_direct()</a> after constructing a <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> with the default constructor! </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#156c2dc4b2ab5db66cf4c6e473257714" title="Prepare a query.">prepare()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="5cd074a713ee48be33eafe051b9005b7"></a><!-- doxytag: member="tiodbc::statement::~statement" ref="5cd074a713ee48be33eafe051b9005b7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tiodbc::statement::~statement           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor. 
<p>
It will close the query or delete the store prepared query, and close the result cursor if any. <dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#1813a912eb6b16e2fd29f5ca91f5b4b0" title="Close statement.">close()</a>; </dd></dl>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b3b67afb374e1f832a9e35895bfc6533"></a><!-- doxytag: member="tiodbc::statement::open" ref="b3b67afb374e1f832a9e35895bfc6533" args="(connection &amp;_conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::open           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_conn</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Used to create a <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> (used automatically by the "statement construction" functions). 
<p>
There is no need to call this function directly. It is called by "Statement construction" function when they want to open a new fresh <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> with the server.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_conn</em>&nbsp;</td><td>The <a class="el" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">connection</a> to the server where the <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> will be opened inside it.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li><b>True</b> If the <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> was successfully opened in the server.</li><li><b>False</b> If there was an error creating the <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>.</li></ul>
</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>If there was an error opening a <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> you can check for detailed error description with <a class="el" href="classtiodbc_1_1connection.html#07d9e69f8b6d25af44e75f4fb6fe32d2" title="Get last error description.">connection::last_error()</a> of the <a class="el" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">connection</a> object that you tried to open the <a class="el" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">connection</a> and <b>NOT</b> by calling <a class="el" href="classtiodbc_1_1statement.html#76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">statement::last_error()</a> as a closed statemenet is unable to do error reporting. </dd></dl>

</div>
</div><p>
<a class="anchor" name="1813a912eb6b16e2fd29f5ca91f5b4b0"></a><!-- doxytag: member="tiodbc::statement::close" ref="1813a912eb6b16e2fd29f5ca91f5b4b0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiodbc::statement::close           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>. 
<p>
It will close the <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>, delete any stored results or prepared queries, or stored parameters. 
</div>
</div><p>
<a class="anchor" name="1282be7fd62870f8adb587a60da9a5b0"></a><!-- doxytag: member="tiodbc::statement::native_stmt_handle" ref="1282be7fd62870f8adb587a60da9a5b0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HDBC tiodbc::statement::native_stmt_handle           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get native HSTMT handle. 
<p>
This is the <b>Statement</b> handle that the object has allocated internally with ODBC ISO API. This handle can be usefull to anyone who needs to use ODBC ISO API alogn with TinyODBC. 
</div>
</div><p>
<a class="anchor" name="76e3d7ac6b66e06e81c85c544aba491b"></a><!-- doxytag: member="tiodbc::statement::last_error" ref="76e3d7ac6b66e06e81c85c544aba491b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a> tiodbc::statement::last_error           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get last error description. 
<p>
Get the description of the error that occured with the last function call. <dl class="return" compact><dt><b>Returns:</b></dt><dd>If the last function call was succesfull it will return an empty string, otherwise it will return the description of the error that occured inside the ODBC driver. </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#6153fa235253c8f9974a0d69762607a6" title="Get last error code.">last_error_status_code()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="6153fa235253c8f9974a0d69762607a6"></a><!-- doxytag: member="tiodbc::statement::last_error_status_code" ref="6153fa235253c8f9974a0d69762607a6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a> tiodbc::statement::last_error_status_code           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get last error code. 
<p>
Get the status of the error that occured with the last function call. <dl class="return" compact><dt><b>Returns:</b></dt><dd>If the last function call was succesfull it will return an empty string, otherwise it will return the status code of the error that occured inside the ODBC driver. </dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>The status codes are unique 5 legth strings that correspond to a unique error. For information of this status code check ODBC API Reference (<a href="http://msdn.microsoft.com/en-us/library/ms716412(VS.85)">http://msdn.microsoft.com/en-us/library/ms716412(VS.85)</a>.aspx)</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error()</a>; </dd></dl>

</div>
</div><p>
<a class="anchor" name="156c2dc4b2ab5db66cf4c6e473257714"></a><!-- doxytag: member="tiodbc::statement::prepare" ref="156c2dc4b2ab5db66cf4c6e473257714" args="(connection &amp;_conn, const _tstring &amp;_stmt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::prepare           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_stmt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Prepare a query. 
<p>
It will close any previous open operation and will prepare an sql query for execution. For more information about <b>query preparation</b> visit <a href="http://msdn.microsoft.com/en-us/library/ms716365.aspx">http://msdn.microsoft.com/en-us/library/ms716365.aspx</a><p>
If you need to execute direct an sql query directly you can use <a class="el" href="classtiodbc_1_1statement.html#1633667ca4afc17cbd5b9dfe9d9822a5" title="Execute directly an sql query to the server.">execute_direct()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_conn</em>&nbsp;</td><td>The <a class="el" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">connection</a> object to prepare the query on it. Queries are always prepared on servers. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_stmt</em>&nbsp;</td><td>The sql query to prepare. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><b>True</b> if the preparation was succesfull or <b>False</b> if there was an error. In case of error check <a class="el" href="classtiodbc_1_1statement.html#76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error()</a> for detailed description of error.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This is a <b>"statement construction" function</b> which means that any previous opened operation of this <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> will be closed and a new <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> will be created. </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param()</a>, <a class="el" href="classtiodbc_1_1statement.html#bab8c3c07df365827230600c7c1576db" title="Execute a prepared statement.">execute()</a>, <a class="el" href="classtiodbc_1_1statement.html#8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a>, <a class="el" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a>, <a class="el" href="classtiodbc_1_1statement.html#1813a912eb6b16e2fd29f5ca91f5b4b0" title="Close statement.">close()</a></dd></dl>
<a class="el" href="examples.html#example_4">Example 4: Prepare a statement and execute it multiple times</a> 
</div>
</div><p>
<a class="anchor" name="1633667ca4afc17cbd5b9dfe9d9822a5"></a><!-- doxytag: member="tiodbc::statement::execute_direct" ref="1633667ca4afc17cbd5b9dfe9d9822a5" args="(connection &amp;_conn, const _tstring &amp;_query)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::execute_direct           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtiodbc_1_1connection.html">connection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacetiodbc.html#7e077c3922ad7d7c1482c810673d86e0">_tstring</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_query</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Execute directly an sql query to the server. 
<p>
It will close any previous opened operation and will execute directly the desired sql query at the server.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_conn</em>&nbsp;</td><td>The <a class="el" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">connection</a> object with the server where the query will be executed at. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_query</em>&nbsp;</td><td>The sql query that will be execute at the server. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><b>True</b> if the execution was succesfull or <b>False</b> if there was an error. In case of error check <a class="el" href="classtiodbc_1_1statement.html#76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error()</a> for detailed description of problem. </dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>After a succesfull execution of a query, the result cursor is pointed one slot before first row. To get the results of first row you must first call once <a class="el" href="classtiodbc_1_1statement.html#8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a> and then use <a class="el" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a> to get each field of the current row.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This is a <b>"statement construction" function</b> which means that any previous opened operation of this <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> will be closed and a new <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> will be created. </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a>, <a class="el" href="classtiodbc_1_1statement.html#33c9ea30bcee5efe5a1fe3a318f6ca9c" title="Count columns of the result set.">count_columns()</a>, <a class="el" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a>, <a class="el" href="classtiodbc_1_1statement.html#1813a912eb6b16e2fd29f5ca91f5b4b0" title="Close statement.">close()</a></dd></dl>
<a class="el" href="examples.html#example_2">Example 2: Execute directly an sql query and get results.</a> <br>
 <a class="el" href="examples.html#example_3">Example 3: Execute directly an "INSERT" sql query.</a> 
</div>
</div><p>
<a class="anchor" name="bab8c3c07df365827230600c7c1576db"></a><!-- doxytag: member="tiodbc::statement::execute" ref="bab8c3c07df365827230600c7c1576db" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::execute           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Execute a prepared <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>. 
<p>
It will execute the query that was previously prepared in this <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>.<p>
To execute a prepared query there are some preconditions that must be satisfied.<br>
<ul>
<li>The statment must be opened and an sql query must have been prepared.</li><li>Any previous result set must be have been freed.</li><li>All the parameters of the prepared <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> must been passed with <a class="el" href="classtiodbc_1_1statement.html#81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param()</a></li></ul>
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><b>True</b> if the prepared query was succesfully executed or <b>False</b> if there was an error. In case of error check <a class="el" href="classtiodbc_1_1statement.html#76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error()</a> for detailed description of problem.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>After a succesfull execution of a query, the result cursor is pointed one slot before first row. To get the results of first row you must first call once <a class="el" href="classtiodbc_1_1statement.html#8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a> and then use <a class="el" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a> to get each field of the current row.</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a>, <a class="el" href="classtiodbc_1_1statement.html#33c9ea30bcee5efe5a1fe3a318f6ca9c" title="Count columns of the result set.">count_columns()</a>, <a class="el" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a>, <a class="el" href="classtiodbc_1_1statement.html#1813a912eb6b16e2fd29f5ca91f5b4b0" title="Close statement.">close()</a></dd></dl>
<a class="el" href="examples.html#example_4">Example 4: Prepare a statement and execute it multiple times</a> 
</div>
</div><p>
<a class="anchor" name="8666cc7f161c58ddb0dbde138cd09d24"></a><!-- doxytag: member="tiodbc::statement::fetch_next" ref="8666cc7f161c58ddb0dbde138cd09d24" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiodbc::statement::fetch_next           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Fetch next result row. 
<p>
If the <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> has opened a result set, it will advance the cursor to the next row. Result sets are opened automatically when executing an sql query that returns some results.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li><b>True</b> if the cursor was advanced succesfully.</li><li><b>False</b> if the end of result set has been reached or there isn't opened any result set.</li></ul>
</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a></dd></dl>
<a class="el" href="examples.html#example_2">Example 2: Execute directly an sql query and get results.</a> <a class="el" href="examples.html#example_4">Example 4: Prepare a statement and execute it multiple times</a> 
</div>
</div><p>
<a class="anchor" name="346c38630d3fc9b2444832592ea92380"></a><!-- doxytag: member="tiodbc::statement::field" ref="346c38630d3fc9b2444832592ea92380" args="(int _num) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classtiodbc_1_1field__impl.html">field_impl</a> tiodbc::statement::field           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>_num</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get a field of the current row in the result set. 
<p>
It will return a field of the current selected row from the result set. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_num</em>&nbsp;</td><td>The column of the field that you want to retrieve. First column is the 1. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>If the operation was successful a valid <a class="el" href="classtiodbc_1_1field__impl.html" title="Representation of result set field.">field_impl</a> object that contains info about the selected field.</li><li>An invalid <a class="el" href="classtiodbc_1_1field__impl.html" title="Representation of result set field.">field_impl</a> if there isn't any result set opened or the result cursor is not pointing to any valid row, or the number of the field was wrong. </li></ul>
</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>Objects returns from <a class="el" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field()</a> should be used directly and must not be stored.<br>
 <b>good</b> example: <div class="fragment"><pre class="fragment"> m_long = <a class="code" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field</a>(1).as_long() 
</pre></div><br>
 <b>bad</b> example: <div class="fragment"><pre class="fragment"> field_impl tmp_field = <a class="code" href="classtiodbc_1_1statement.html#346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field</a>(1);  m_long = tmp_field.as_long(); 
</pre></div> </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classtiodbc_1_1statement.html#8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next()</a>;</dd></dl>
<a class="el" href="examples.html#example_2">Example 2: Execute directly an sql query and get results.</a> <br>
 <a class="el" href="examples.html#example_4">Example 4: Prepare a statement and execute it multiple times</a> 
</div>
</div><p>
<a class="anchor" name="33c9ea30bcee5efe5a1fe3a318f6ca9c"></a><!-- doxytag: member="tiodbc::statement::count_columns" ref="33c9ea30bcee5efe5a1fe3a318f6ca9c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tiodbc::statement::count_columns           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Count columns of the result set. 
<p>
It will return the number of columns of the current open result set. <dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>If the operation was <b>successful</b> it will return a number <b>bigger than zero</b>.</li><li><b>Less than zero or equal to</b> in case of any <b>error</b>.</li></ul>
</dd></dl>
<a class="el" href="examples.html#example_2">Example 2: Execute directly an sql query and get results.</a> 
</div>
</div><p>
<a class="anchor" name="81b7f2c1f9ad1c922e57b38bbdbc8042"></a><!-- doxytag: member="tiodbc::statement::param" ref="81b7f2c1f9ad1c922e57b38bbdbc8042" args="(int _num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtiodbc_1_1param__impl.html">param_impl</a> &amp; tiodbc::statement::param           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>_num</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle a parameter. 
<p>
Returns a handle to a parameter of the prepared <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_num</em>&nbsp;</td><td>The parameter number, starting from 1. This is the way ODBC uses to identify the parameter markers. If there are three parameters, the leftmost one is parameter no.1 and the rightmost is parameter no.3</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>If the operation was successful a valid <a class="el" href="classtiodbc_1_1param__impl.html" title="Handler prepared statements parameters.">param_impl</a> object that can be used to set a value to the specific parameter.</li><li>An invalid <a class="el" href="classtiodbc_1_1param__impl.html" title="Handler prepared statements parameters.">param_impl</a> object if there isn't any prepared <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>, or the parameter number is wrong. </li></ul>
</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>Objects returns from <a class="el" href="classtiodbc_1_1statement.html#81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param()</a> should be used directly and must not be stored.<br>
 <b>good</b> example: <div class="fragment"><pre class="fragment"> = <a class="code" href="classtiodbc_1_1statement.html#81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param</a>(1).set_as_long(1) 
</pre></div><br>
 <b>bad</b> example: <div class="fragment"><pre class="fragment"> param_impl tmp_parm = <a class="code" href="classtiodbc_1_1statement.html#81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param</a>(1);  tmp_parm.set_as_long(1); 
</pre></div> </dd></dl>

</div>
</div><p>
<a class="anchor" name="76d8d1523dcc0bc344b5c40c50721336"></a><!-- doxytag: member="tiodbc::statement::reset_parameters" ref="76d8d1523dcc0bc344b5c40c50721336" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiodbc::statement::reset_parameters           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reset parameters (unbind all parameters). 
<p>
It will remove (unbind) all the setted parameters of the prepared <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a>.<p>
In case that this is not a prepared <a class="el" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">statement</a> it will fail silently. 
</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>C:/Users/sque/SVN/tiodbc2/trunk/<a class="el" href="tiodbc_8hpp-source.html">tiodbc.hpp</a><li>C:/Users/sque/SVN/tiodbc2/trunk/tiodbc.cpp</ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jun 9 01:44:56 2008 for TinyODBC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
