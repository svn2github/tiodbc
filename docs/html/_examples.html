<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TinyODBC: </title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="examples_demo"></a>
Examples Demostration</h2>
<h3><a class="anchor" id="example_1"></a>
Example 1: Connecting and disconnecting from a server.</h3>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;./tiodbc.hpp&quot;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>

<span class="keyword">using namespace </span>std;

<span class="keywordtype">int</span> main()
{   
   <span class="comment">// Create a connection with an ODBC Data Source</span>
    <a class="code" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">tiodbc::connection</a> my_connection(<span class="stringliteral">&quot;MyDSN&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);

    <span class="comment">// Check if it was connected succesfully</span>
    <span class="keywordflow">if</span> (my_connection.connected())
        cout &lt;&lt; <span class="stringliteral">&quot;Connection has been accomplished&quot;</span>;
    <span class="keywordflow">else</span>
        cout &lt;&lt; <span class="stringliteral">&quot;Error connecting with server&quot;</span> &lt;&lt; endl
            &lt;&lt; my_connection.last_error();

    
    <span class="comment">// Do more things here</span>
    <span class="comment">//.....</span>

    <span class="comment">// Disconnect</span>
    my_connection.disconnect();

    <span class="keywordflow">return</span> 0;
}
</pre></div><h3><a class="anchor" id="example_2"></a>
Example 2: Execute directly an sql query and get results.</h3>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;./tiodbc.hpp&quot;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>

<span class="keyword">using namespace </span>std;

<span class="keywordtype">int</span> main()
{   
    <a class="code" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">tiodbc::connection</a> my_connection;
    <a class="code" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">tiodbc::statement</a> my_statement;

    <span class="comment">// Create a connection with an ODBC Data Source</span>
    <span class="keywordflow">if</span> (!my_connection.<a class="code" href="classtiodbc_1_1connection.html#a4e11f36607613fef7d50507a14dcf008" title="Connect to a Data Source.">connect</a>(<span class="stringliteral">&quot;MyDSN&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>))
    {
        cout &lt;&lt; <span class="stringliteral">&quot;Cannot connect to the Data Source&quot;</span> &lt;&lt; endl
            &lt;&lt; my_connection.<a class="code" href="classtiodbc_1_1connection.html#a07d9e69f8b6d25af44e75f4fb6fe32d2" title="Get last error description.">last_error</a>();
        <span class="keywordflow">return</span> 1;
    }

    <span class="comment">// Execute a direct query</span>
    <span class="keywordflow">if</span> (!my_statement.<a class="code" href="classtiodbc_1_1statement.html#a1633667ca4afc17cbd5b9dfe9d9822a5" title="Execute directly an sql query to the server.">execute_direct</a>(my_connection, <span class="stringliteral">&quot;SELECT * FROM my_table&quot;</span>))
    {
        cout &lt;&lt; <span class="stringliteral">&quot;Cannot execute query!&quot;</span> &lt;&lt; endl
            &lt;&lt; my_connection.<a class="code" href="classtiodbc_1_1connection.html#a07d9e69f8b6d25af44e75f4fb6fe32d2" title="Get last error description.">last_error</a>();
        <span class="keywordflow">return</span> 2;
    }

    <span class="comment">// Get results from statement</span>
    <span class="keywordflow">while</span>(my_statement.<a class="code" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next</a>())
    {
        <span class="comment">// print all fields for each row</span>
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1;i &lt;= my_statement.<a class="code" href="classtiodbc_1_1statement.html#a33c9ea30bcee5efe5a1fe3a318f6ca9c" title="Count columns of the result set.">count_columns</a>(); i ++)
            cout &lt;&lt; my_statement.<a class="code" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field</a>(i).as_string() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;

        cout &lt;&lt; endl;
    }
    <span class="keywordflow">return</span> 0;
}
</pre></div><h3><a class="anchor" id="example_3"></a>
Example 3: Execute directly an "INSERT" sql query.</h3>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;./tiodbc.hpp&quot;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>

<span class="keyword">using namespace </span>std;

<span class="keywordtype">int</span> main()
{   
    <a class="code" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">tiodbc::connection</a> my_connection;
    <a class="code" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">tiodbc::statement</a> my_statement;

    <span class="comment">// Create a connection with an ODBC Data Source</span>
    <span class="keywordflow">if</span> (!my_connection.<a class="code" href="classtiodbc_1_1connection.html#a4e11f36607613fef7d50507a14dcf008" title="Connect to a Data Source.">connect</a>(<span class="stringliteral">&quot;MyDSN&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>))
    {
        cout &lt;&lt; <span class="stringliteral">&quot;Cannot connect to the Data Source&quot;</span> &lt;&lt; endl
            &lt;&lt; my_connection.<a class="code" href="classtiodbc_1_1connection.html#a07d9e69f8b6d25af44e75f4fb6fe32d2" title="Get last error description.">last_error</a>();
        <span class="keywordflow">return</span> 1;
    }

    <span class="comment">// Execute a direct query</span>
    <span class="keywordflow">if</span> (!my_statement.<a class="code" href="classtiodbc_1_1statement.html#a1633667ca4afc17cbd5b9dfe9d9822a5" title="Execute directly an sql query to the server.">execute_direct</a>(my_connection,
        <span class="stringliteral">&quot;INSERT INTO books (id, title, author) VALUES(\&#39;0\&#39;, \&#39;TinyODBC Manual\&#39;, \&#39;sque\&#39;)&quot;</span>))
    {
        cout &lt;&lt; <span class="stringliteral">&quot;Cannot execute query!&quot;</span> &lt;&lt; endl
            &lt;&lt; my_connection.<a class="code" href="classtiodbc_1_1connection.html#a07d9e69f8b6d25af44e75f4fb6fe32d2" title="Get last error description.">last_error</a>();
        <span class="keywordflow">return</span> 2;
    }

    <span class="keywordflow">return</span> 0;
}
</pre></div><h3><a class="anchor" id="example_4"></a>
Example 4: Prepare a statement and execute it multiple times</h3>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;./tiodbc.hpp&quot;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>

<span class="keyword">using namespace </span>std;

<span class="keywordtype">int</span> main()
{   
    <a class="code" href="classtiodbc_1_1connection.html" title="An ODBC connection representation object.">tiodbc::connection</a> my_connection;
    <a class="code" href="classtiodbc_1_1statement.html" title="An ODBC statement representation object.">tiodbc::statement</a> my_statement;

    <span class="comment">// Create a connection with an ODBC Data Source</span>
    <span class="keywordflow">if</span> (!my_connection.<a class="code" href="classtiodbc_1_1connection.html#a4e11f36607613fef7d50507a14dcf008" title="Connect to a Data Source.">connect</a>(<span class="stringliteral">&quot;MyDSN&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>))
    {
        cout &lt;&lt; <span class="stringliteral">&quot;Cannot connect to the Data Source&quot;</span> &lt;&lt; endl
            &lt;&lt; my_connection.<a class="code" href="classtiodbc_1_1connection.html#a07d9e69f8b6d25af44e75f4fb6fe32d2" title="Get last error description.">last_error</a>();
        <span class="keywordflow">return</span> 1;
    }

    <span class="comment">// Prepare the query</span>
    <span class="keywordflow">if</span> (!my_statement.<a class="code" href="classtiodbc_1_1statement.html#a156c2dc4b2ab5db66cf4c6e473257714" title="Prepare a query.">prepare</a>(my_connection, <span class="stringliteral">&quot;SELECT * FROM books WHERE author_id = ?&quot;</span>))
    {
        cout &lt;&lt; <span class="stringliteral">&quot;Cannot prepare query!&quot;</span> &lt;&lt; endl
            &lt;&lt; my_connection.<a class="code" href="classtiodbc_1_1connection.html#a07d9e69f8b6d25af44e75f4fb6fe32d2" title="Get last error description.">last_error</a>();
        <span class="keywordflow">return</span> 2;
    }

    <span class="comment">// Execute it with parameter (author_id) &quot;2&quot;</span>
    my_statement.<a class="code" href="classtiodbc_1_1statement.html#a81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param</a>(1).set_as_long(2);
    <span class="keywordflow">if</span> (!my_statement.<a class="code" href="classtiodbc_1_1statement.html#abab8c3c07df365827230600c7c1576db" title="Execute a prepared statement.">execute</a>())
    {
        cout &lt;&lt; <span class="stringliteral">&quot;Cannot execute prepared query!&quot;</span> &lt;&lt; endl
            &lt;&lt; my_statement.<a class="code" href="classtiodbc_1_1statement.html#a76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error</a>();
        <span class="keywordflow">return</span> 2;
    }

    <span class="comment">// Get results from statement</span>
    <span class="keywordflow">while</span>(my_statement.<a class="code" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next</a>())
    {
        <span class="comment">// print all fields for each row</span>
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1;i &lt;= my_statement.<a class="code" href="classtiodbc_1_1statement.html#a33c9ea30bcee5efe5a1fe3a318f6ca9c" title="Count columns of the result set.">count_columns</a>(); i ++)
            cout &lt;&lt; my_statement.<a class="code" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field</a>(i).as_string() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;

        cout &lt;&lt; endl;
    }

    <span class="comment">// Execute again with parameter (author_id) &quot;1&quot;</span>
    my_statement.<a class="code" href="classtiodbc_1_1statement.html#a81b7f2c1f9ad1c922e57b38bbdbc8042" title="Handle a parameter.">param</a>(1).set_as_long(1);
    <span class="keywordflow">if</span> (!my_statement.<a class="code" href="classtiodbc_1_1statement.html#abab8c3c07df365827230600c7c1576db" title="Execute a prepared statement.">execute</a>())
    {
        cout &lt;&lt; <span class="stringliteral">&quot;Cannot execute prepared query!&quot;</span> &lt;&lt; endl
            &lt;&lt; my_statement.<a class="code" href="classtiodbc_1_1statement.html#a76e3d7ac6b66e06e81c85c544aba491b" title="Get last error description.">last_error</a>();
        <span class="keywordflow">return</span> 2;
    }

    <span class="comment">// Get results from statement</span>
    <span class="keywordflow">while</span>(my_statement.<a class="code" href="classtiodbc_1_1statement.html#a8666cc7f161c58ddb0dbde138cd09d24" title="Fetch next result row.">fetch_next</a>())
    {
        <span class="comment">// print all fields for each row</span>
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1;i &lt;= my_statement.<a class="code" href="classtiodbc_1_1statement.html#a33c9ea30bcee5efe5a1fe3a318f6ca9c" title="Count columns of the result set.">count_columns</a>(); i ++)
            cout &lt;&lt; my_statement.<a class="code" href="classtiodbc_1_1statement.html#a346c38630d3fc9b2444832592ea92380" title="Get a field of the current row in the result set.">field</a>(i).as_string() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;

        cout &lt;&lt; endl;
    }
    <span class="keywordflow">return</span> 0;
}
</pre></div> </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Typedefs</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Thu Mar 10 2011 03:02:28 for TinyODBC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
